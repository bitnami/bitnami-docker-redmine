machine:
  services:
  - docker
  environment:
    RELEASE_SERIES_LIST: 3
    LATEST_STABLE: 3
    IMAGE_NAME: redmine
    CHART_NAME: redmine
    CHART_REPO: https://github.com/damagehead/charts
    DOCKER_PROJECT: experimental
    GCLOUD_PROJECT:

dependencies:
  override:
  - docker info
  - gcloud version
  - curl -sL https://raw.githubusercontent.com/sameersbn/test-infra/development-builds/circle/docker-pull-cache.sh | bash -

test:
  override:
  - curl -sL https://raw.githubusercontent.com/sameersbn/test-infra/development-builds/circle/docker-image-test.sh | bash -

deployment:
  cache:
    branch: master
    commands:
    - curl -sL https://raw.githubusercontent.com/sameersbn/test-infra/development-builds/circle/docker-update-cache.sh | bash -
  release:
    tag: /^[0-9].*-r[0-9]+$/
    commands:
    - curl -sL https://raw.githubusercontent.com/sameersbn/test-infra/development-builds/circle/docker-release-image.sh | bash -
